<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Яндекс.Дом</title>

    <!-- Preload критических ресурсов -->
    <link rel="preload" href="assets_tiny/logo.svg" as="image" type="image/svg+xml">
    <link rel="preload" href="assets_tiny/bg@2x.png" as="image" type="image/png">
    <link rel="preload" href="assets_tiny/icon_list_m@1x.svg" as="image" type="image/svg+xml">

    <!-- Оптимизированные стили -->
    <link rel="stylesheet" type="text/css" href="reset.css">
    <link rel="stylesheet" type="text/css" href="styles.min.css">
</head>
<body>

<div id="app">
    <header class="header">
        <a href="/" class="header__logo" aria-label="Яндекс.Дом"></a>
        <button class="header__menu" aria-expanded="false">
            <span class="header__menu-text a11y-hidden">Открыть меню</span>
        </button>
        <ul class="header__links">
            <li class="header__item">
                <a class="header__link header__link_current" href="/" aria-current="page">Сводка</a>
            </li>
            <li class="header__item">
                <a class="header__link" href="/devices">Устройства</a>
            </li>
            <li class="header__item">
                <a class="header__link" href="/scripts">Сценарии</a>
            </li>
        </ul>
    </header>

    <main class="main">
        <section class="section main__general">
            <h2 class="section__title section__title-header section__main-title">Главное</h2>
            <div class="hero-dashboard">
                <div class="hero-dashboard__primary">
                    <h3 class="hero-dashboard__title">Привет, Геннадий!</h3>
                    <p class="hero-dashboard__subtitle">Двери и окна закрыты, сигнализация включена.</p>
                    <ul class="hero-dashboard__info">
                        <li class="hero-dashboard__item">
                            <div class="hero-dashboard__item-title">Дома</div>
                            <div class="hero-dashboard__item-details">
                                +23
                                <span class="a11y-hidden">°</span>
                            </div>
                        </li>
                        <li class="hero-dashboard__item">
                            <div class="hero-dashboard__item-title">За окном</div>
                            <div class="hero-dashboard__item-details">
                                +19
                                <span class="a11y-hidden">°</span>
                                <div class="hero-dashboard__icon hero-dashboard__icon_rain" role="img" aria-label="Дождь"></div>
                            </div>
                        </li>
                    </ul>
                </div>
                <ul class="hero-dashboard__schedule">
                    <li class="event">
                        <button class="event__button">
                            <span class="event__icon event__icon_temp" role="img" aria-label="Температура"></span>
                            <h4 class="event__title">Philips Cooler</h4>
                            <span class="event__subtitle">Начнет охлаждать в 16:30</span>
                        </button>
                    </li>
                    <li class="event">
                        <button class="event__button">
                            <span class="event__icon event__icon_light" role="img" aria-label="Освещение"></span>
                            <h4 class="event__title">Xiaomi Yeelight LED Smart Bulb</h4>
                            <span class="event__subtitle">Включится в 17:00</span>
                        </button>
                    </li>
                    <li class="event">
                        <button class="event__button">
                            <span class="event__icon event__icon_light" role="img" aria-label="Освещение"></span>
                            <h4 class="event__title">Xiaomi Yeelight LED Smart Bulb</h4>
                            <span class="event__subtitle">Включится в 17:00</span>
                        </button>
                    </li>
                </ul>
            </div>
        </section>

        <section class="section main__scripts">
            <h2 class="section__title section__title-header">Избранные сценарии</h2>
            <ul class="event-grid">
                <li class="event event_slim">
                    <button class="event__button">
                        <span class="event__icon event__icon_light2" role="img" aria-label="Освещение"></span>
                        <h4 class="event__title">Выключить весь свет в доме и во дворе</h4>
                    </button>
                </li>
                <li class="event event_slim">
                    <button class="event__button">
                        <span class="event__icon event__icon_schedule" role="img" aria-label="Расписание"></span>
                        <h4 class="event__title">Я ухожу</h4>
                    </button>
                </li>
                <li class="event event_slim">
                    <button class="event__button">
                        <span class="event__icon event__icon_light2" role="img" aria-label="Освещение"></span>
                        <h4 class="event__title">Включить свет в коридоре</h4>
                    </button>
                </li>
                <li class="event event_slim">
                    <button class="event__button">
                        <span class="event__icon event__icon_temp2" role="img" aria-label="Температура"></span>
                        <h4 class="event__title">Набрать горячую ванну</h4>
                        <span class="event__subtitle">Начнётся в 18:00</span>
                    </button>
                </li>
                <li class="event event_slim">
                    <button class="event__button">
                        <span class="event__icon event__icon_temp2" role="img" aria-label="Температура"></span>
                        <h4 class="event__title">Сделать пол тёплым во всей квартире</h4>
                    </button>
                </li>
            </ul>
        </section>

        <section class="section main__devices">
            <div class="section__title">
                <h2 class="section__title-header">Избранные устройства</h2>
                <select class="section__select" id="deviceSelect">
                    <option value="all">Все</option>
                    <option value="kitchen">Кухня</option>
                    <option value="hall">Зал</option>
                    <option value="lights">Лампочки</option>
                    <option value="cameras">Камеры</option>
                </select>
                <ul role="tablist" class="section__tabs">
                    <li role="tab" aria-selected="true" tabindex="0" class="section__tab section__tab_active" id="tab_all" aria-controls="panel_all" data-tab="all">Все</li>
                    <li role="tab" aria-selected="false" class="section__tab" id="tab_kitchen" aria-controls="panel_kitchen" data-tab="kitchen">Кухня</li>
                    <li role="tab" aria-selected="false" class="section__tab" id="tab_hall" aria-controls="panel_hall" data-tab="hall">Зал</li>
                    <li role="tab" aria-selected="false" class="section__tab" id="tab_lights" aria-controls="panel_lights" data-tab="lights">Лампочки</li>
                    <li role="tab" aria-selected="false" class="section__tab" id="tab_cameras" aria-controls="panel_cameras" data-tab="cameras">Камеры</li>
                </ul>
            </div>
            <div class="section__panel-wrapper" id="panelWrapper">
                <div role="tabpanel" class="section__panel" aria-hidden="false" id="panel_all" aria-labelledby="tab_all">
                    <ul class="section__panel-list" id="allDevices"></ul>
                </div>
                <div role="tabpanel" class="section__panel section__panel_hidden" aria-hidden="true" id="panel_kitchen" aria-labelledby="tab_kitchen">
                    <ul class="section__panel-list" id="kitchenDevices"></ul>
                </div>
                <div role="tabpanel" class="section__panel section__panel_hidden" aria-hidden="true" id="panel_hall" aria-labelledby="tab_hall">
                    <ul class="section__panel-list" id="hallDevices"></ul>
                </div>
                <div role="tabpanel" class="section__panel section__panel_hidden" aria-hidden="true" id="panel_lights" aria-labelledby="tab_lights">
                    <ul class="section__panel-list" id="lightsDevices"></ul>
                </div>
                <div role="tabpanel" class="section__panel section__panel_hidden" aria-hidden="true" id="panel_cameras" aria-labelledby="tab_cameras">
                    <ul class="section__panel-list" id="camerasDevices"></ul>
                </div>
            </div>
        </section>
    </main>
</div>

<footer class="footer">
    <ul class="footer__list">
        <li class="footer__item">
            <a class="footer__link" href="/">Помощь</a>
        </li>
        <li class="footer__item">
            <a class="footer__link" href="/">Обратная связь</a>
        </li>
        <li class="footer__item">
            <a class="footer__link" href="/">Разработчикам</a>
        </li>
        <li class="footer__item">
            <a class="footer__link" href="/">Условия использования</a>
        </li>
    </ul>

    <div class="footer__copyright">
        © 1997–2023 ООО «Яндекс»
    </div>
</footer>

<script>
(function() {
    'use strict';

    // Данные устройств
    const DEVICES_DATA = {
        all: [
            {icon: 'light2', iconLabel: 'Освещение', title: 'Xiaomi Yeelight LED Smart Bulb', subtitle: 'Включено'},
            {icon: 'light', iconLabel: 'Освещение', title: 'D-Link Omna 180 Cam', subtitle: 'Включится в 17:00'},
            {icon: 'temp', iconLabel: 'Температура', title: 'Elgato Eve Degree Connected', subtitle: 'Выключено до 17:00'},
            {icon: 'light', iconLabel: 'Освещение', title: 'LIFX Mini Day & Dusk A60 E27', subtitle: 'Включится в 17:00'},
            {icon: 'light2', iconLabel: 'Освещение', title: 'Xiaomi Mi Air Purifier 2S', subtitle: 'Включено'},
            {icon: 'light', iconLabel: 'Освещение', title: 'Philips Zhirui', subtitle: 'Включено'},
            {icon: 'light', iconLabel: 'Освещение', title: 'Philips Zhirui', subtitle: 'Включено'},
            {icon: 'light2', iconLabel: 'Освещение', title: 'Xiaomi Mi Air Purifier 2S', subtitle: 'Включено'}
        ],
        kitchen: [
            {icon: 'light2', iconLabel: 'Освещение', title: 'Xiaomi Yeelight LED Smart Bulb', subtitle: 'Включено'},
            {icon: 'temp', iconLabel: 'Температура', title: 'Elgato Eve Degree Connected', subtitle: 'Выключено до 17:00'}
        ],
        hall: [
            {icon: 'light', iconLabel: 'Освещение', title: 'Philips Zhirui', subtitle: 'Выключено'},
            {icon: 'light2', iconLabel: 'Освещение', title: 'Xiaomi Mi Air Purifier 2S', subtitle: 'Выключено'}
        ],
        lights: [
            {icon: 'light', iconLabel: 'Освещение', title: 'D-Link Omna 180 Cam', subtitle: 'Включится в 17:00'},
            {icon: 'light', iconLabel: 'Освещение', title: 'LIFX Mini Day & Dusk A60 E27', subtitle: 'Включится в 17:00'},
            {icon: 'light2', iconLabel: 'Освещение', title: 'Xiaomi Mi Air Purifier 2S', subtitle: 'Включено'},
            {icon: 'light', iconLabel: 'Освещение', title: 'Philips Zhirui', subtitle: 'Включено'}
        ],
        cameras: [
            {icon: 'light2', iconLabel: 'Освещение', title: 'Xiaomi Mi Air Purifier 2S', subtitle: 'Включено'}
        ]
    };

    // Увеличиваем количество элементов для тестирования производительности
    for (let i = 0; i < 6; ++i) {
        DEVICES_DATA.all = [...DEVICES_DATA.all, ...DEVICES_DATA.all];
    }

    // Создание элемента устройства
    function createDeviceElement(device) {
        const li = document.createElement('li');
        li.className = 'event';

        const button = document.createElement('button');
        button.className = 'event__button';

        const icon = document.createElement('span');
        icon.className = `event__icon event__icon_${device.icon}`;
        icon.setAttribute('role', 'img');
        icon.setAttribute('aria-label', device.iconLabel);

        const title = document.createElement('h4');
        title.className = 'event__title';
        title.textContent = device.title;

        button.appendChild(icon);
        button.appendChild(title);

        if (device.subtitle) {
            const subtitle = document.createElement('span');
            subtitle.className = 'event__subtitle';
            subtitle.textContent = device.subtitle;
            button.appendChild(subtitle);
        }

        li.appendChild(button);
        return li;
    }

    // Заполнение панелей устройствами
    function populateDevices() {
        Object.keys(DEVICES_DATA).forEach(category => {
            const container = document.getElementById(`${category}Devices`);
            if (container) {
                container.innerHTML = '';
                DEVICES_DATA[category].forEach(device => {
                    container.appendChild(createDeviceElement(device));
                });
            }
        });
    }

    // Переключение вкладок
    function switchTab(tabName) {
        // Обновляем атрибуты вкладок
        document.querySelectorAll('.section__tab').forEach(tab => {
            const isActive = tab.dataset.tab === tabName;
            tab.setAttribute('aria-selected', isActive);
            tab.classList.toggle('section__tab_active', isActive);
            tab.tabIndex = isActive ? '0' : -1;
        });

        // Обновляем панели
        document.querySelectorAll('.section__panel').forEach(panel => {
            const isActive = panel.id === `panel_${tabName}`;
            panel.classList.toggle('section__panel_hidden', !isActive);
            panel.setAttribute('aria-hidden', !isActive);
        });

        // Обновляем селект
        const select = document.getElementById('deviceSelect');
        if (select) {
            select.value = tabName;
        }
    }

    // Обработчик клика по вкладкам
    function handleTabClick(event) {
        const tab = event.target.closest('.section__tab');
        if (tab) {
            switchTab(tab.dataset.tab);
        }
    }

    // Обработчик изменения селекта
    function handleSelectChange(event) {
        switchTab(event.target.value);
    }

    // Обработчик мобильного меню
    function handleMobileMenu() {
        const menuButton = document.querySelector('.header__menu');
        const menuLinks = document.querySelector('.header__links');

        if (menuButton && menuLinks) {
            menuButton.addEventListener('click', function() {
                const isExpanded = this.getAttribute('aria-expanded') === 'true';
                this.setAttribute('aria-expanded', !isExpanded);

                const menuText = this.querySelector('.header__menu-text');
                if (menuText) {
                    menuText.textContent = isExpanded ? 'Открыть меню' : 'Закрыть меню';
                }

                menuLinks.classList.toggle('header__links_opened');
                if (!menuLinks.classList.contains('header__links-toggled')) {
                    menuLinks.classList.add('header__links-toggled');
                }
            });
        }
    }

    // Инициализация
    function init() {
        // Заполняем устройства
        populateDevices();

        // Устанавливаем активную вкладку из URL или по умолчанию
        const urlParams = new URLSearchParams(location.search);
        const activeTab = urlParams.get('tab') || 'all';
        switchTab(activeTab);

        // Добавляем обработчики событий
        document.querySelector('.section__tabs').addEventListener('click', handleTabClick);
        document.getElementById('deviceSelect').addEventListener('change', handleSelectChange);
        handleMobileMenu();

        // Добавляем обработчик клавиатуры для вкладок
        document.querySelector('.section__tabs').addEventListener('keydown', function(event) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                const tab = event.target.closest('.section__tab');
                if (tab) {
                    switchTab(tab.dataset.tab);
                }
            }
        });
    }

    // Запускаем после загрузки DOM
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
</script>

</body>
</html>
